!function(e,t){"function"==typeof define&&define.amd?define(["fetch"],(function(r){return e.snxSubgraph=t(r)})):"object"==typeof module&&module.exports?module.exports=t(require("node-fetch")):e.snxData=t(e.fetch)}("undefined"!=typeof self?self:this,(function(e){"use strict";const t="https://api.thegraph.com/subgraphs/name/synthetixio-team/synthetix-exchanges",r=({api:t,queryCreator:r,field:o})=>{const n=({skip:s})=>e(t,{method:"POST",body:r({skip:s})}).then(e=>e.json()).then(e=>{if(e.errors)throw Error(JSON.stringify(e.errors));const{data:{[o]:t}}=e;return t.length<100?t:n({skip:s+100}).then(e=>t.concat(e))});return n({skip:0})},o=e=>{const t=e.toString();let r="";for(let e=2;e<t.length;e+=2){const o=t.substr(e,2);"00"!==o&&(r+=String.fromCharCode(parseInt(o,16)))}return r};return{pageResults:r,exchanges:{since:({network:e="mainnet",timestampInSecs:n=Math.floor(Date.now()/1e3)-86400}={})=>r({api:t,field:"synthExchanges",queryCreator:({skip:t})=>`{"query":"{synthExchanges(first:100,skip:${t},orderBy:timestamp,orderDirection:desc,where:{network: \\"${e}\\", timestamp_gt: ${n}}){id,from,gasPrice,from,fromAmount,fromAmountInUSD,fromCurrencyKey,toCurrencyKey,toAddress,toAmount,toAmountInUSD,feesInUSD,block,timestamp}}","variables":null}`}).then(e=>e.map(({gasPrice:e,timestamp:t,id:r,from:n,fromAmount:s,block:m,fromAmountInUSD:i,fromCurrencyKey:u,toAddress:a,toAmount:c,toAmountInUSD:f,toCurrencyKey:h,feesInUSD:y})=>({gasPrice:e/1e9,block:m,timestamp:Number(1e3*t),date:new Date(1e3*t),hash:r.split("-")[0],fromAddress:n,fromAmount:s/1e18,fromCurrencyKeyBytes:u,fromCurrencyKey:o(u),fromAmountInUSD:i/1e18,toAmount:c/1e18,toAmountInUSD:f/1e18,toCurrencyKeyBytes:h,toCurrencyKey:o(h),toAddress:a,feesInUSD:y/1e18}))).catch(e=>console.error(e))}}}));
