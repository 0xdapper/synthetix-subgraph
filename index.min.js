!function(e,t){"function"==typeof define&&define.amd?define(["fetch"],(function(r){return e.snxSubgraph=t(r)})):"object"==typeof module&&module.exports?module.exports=t(require("node-fetch")):e.snxData=t(e.fetch)}("undefined"!=typeof self?self:this,(function(e){"use strict";const t="https://api.thegraph.com/subgraphs/name/synthetixio-team/synthetix-exchanges",r=({api:t,queryCreator:r,field:n})=>{const o=({skip:s})=>e(t,{method:"POST",body:r({skip:s})}).then(e=>e.json()).then(e=>{if(e.errors)throw Error(JSON.stringify(e.errors));const{data:{[n]:t}}=e;return t.length<100?t:o({skip:s+100}).then(e=>t.concat(e))});return o({skip:0})},n=e=>{const t=e.toString();let r="";for(let e=2;e<t.length;e+=2){const n=t.substr(e,2);"00"!==n&&(r+=String.fromCharCode(parseInt(n,16)))}return r};return{pageResults:r,exchanges:{total:({network:e="mainnet"}={})=>r({api:t,field:"totals",queryCreator:()=>`{"query": "{totals(first: 1, where: {id: \\"${e}\\"}){id,exchangers,exchangeUSDTally,totalFeesGeneratedInUSD}}", "variables": null}`}).then(([{id:e,exchangers:t,exchangeUSDTally:r,totalFeesGeneratedInUSD:n}])=>({id:e,exchangers:Number(t),exchangeUSDTally:r/1e18,totalFeesGeneratedInUSD:n/1e18})).catch(e=>console.error(e)),since:({network:e="mainnet",timestampInSecs:o=Math.floor(Date.now()/1e3)-86400}={})=>r({api:t,field:"synthExchanges",queryCreator:({skip:t})=>`{"query":"{synthExchanges(first:100,skip:${t},orderBy:timestamp,orderDirection:desc,where:{network: \\"${e}\\", timestamp_gt: ${o}}){id,from,gasPrice,from,fromAmount,fromAmountInUSD,fromCurrencyKey,toCurrencyKey,toAddress,toAmount,toAmountInUSD,feesInUSD,block,timestamp}}","variables":null}`}).then(e=>e.map(({gasPrice:e,timestamp:t,id:r,from:o,fromAmount:s,block:a,fromAmountInUSD:i,fromCurrencyKey:m,toAddress:c,toAmount:u,toAmountInUSD:f,toCurrencyKey:h,feesInUSD:d})=>({gasPrice:e/1e9,block:a,timestamp:Number(1e3*t),date:new Date(1e3*t),hash:r.split("-")[0],fromAddress:o,fromAmount:s/1e18,fromCurrencyKeyBytes:m,fromCurrencyKey:n(m),fromAmountInUSD:i/1e18,toAmount:u/1e18,toAmountInUSD:f/1e18,toCurrencyKeyBytes:h,toCurrencyKey:n(h),toAddress:c,feesInUSD:d/1e18}))).catch(e=>console.error(e))}}}));
