!function(e,t){"function"==typeof define&&define.amd?define(["fetch"],(function(r){return e.snxSubgraph=t(r)})):"object"==typeof module&&module.exports?module.exports=t(require("node-fetch")):e.snxData=t(e.fetch)}("undefined"!=typeof self?self:this,(function(e){"use strict";const t="https://api.thegraph.com/subgraphs/name/synthetixio-team/synthetix-exchanges",r=({api:t,queryCreator:r,field:n})=>{const o=({skip:s})=>e(t,{method:"POST",body:r({skip:s})}).then(e=>e.json()).then(e=>{if(e.errors)throw Error(JSON.stringify(e.errors));const{data:{[n]:t}}=e;return t.length<100?t:o({skip:s+100}).then(e=>t.concat(e))});return o({skip:0})},n=e=>{const t=e.toString();let r="";for(let e=2;e<t.length;e+=2){const n=t.substr(e,2);"00"!==n&&(r+=String.fromCharCode(parseInt(n,16)))}return r};return{pageResults:r,exchanges:{since:({timestampInSecs:e=Math.floor(Date.now()/1e3)-86400}={})=>r({api:t,field:"synthExchanges",queryCreator:({skip:t})=>`{"query":"{synthExchanges(first:100,skip:${t},orderBy:timestamp,orderDirection:desc,where:{timestamp_gt: ${e}}){id,from,gasPrice,fromAmount,fromAmountInUSD,fromCurrencyKey,toCurrencyKey,toAmount,toAmountInUSD,feesInUSD,block,timestamp,toAddress}}","variables":null}`}).then(e=>e.map(({gasPrice:e,timestamp:t,id:r,fromAmount:o,fromAmountInUSD:s,fromCurrencyKey:i,toAmount:m,toAmountInUSD:u,toCurrencyKey:a,feesInUSD:c})=>({gasPrice:e/1e9,timestamp:Number(1e3*t),date:new Date(1e3*t),hash:r.split("-")[0],fromAmount:o/1e18,fromCurrencyKeyBytes:i,fromCurrencyKey:n(i),fromAmountInUSD:s/1e18,toAmount:m/1e18,toAmountInUSD:u/1e18,toCurrencyKeyBytes:a,toCurrencyKey:n(a),feesInUSD:c/1e18}))).catch(e=>console.error(e))}}}));
